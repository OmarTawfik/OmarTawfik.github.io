{% if page.meta.comments %}
  <h2>{{ lang.t("meta.comments") }}</h2>

  <!-- Load Giscus -->
  
  <script src="https://giscus.app/client.js"
          data-repo="OmarTawfik/OmarTawfik.github.io"
          data-repo-id="R_kgDOJKMyKA"
          data-category="Blog Posts"
          data-category-id="DIC_kwDOJKMyKM4CU6DM"
          data-mapping="title"
          data-strict="1"
          data-reactions-enabled="1"
          data-emit-metadata="0"
          data-input-position="bottom"
          data-theme="preferred_color_scheme"
          data-lang="en"
          data-loading="lazy"
          crossorigin="anonymous"
          async>
  </script>

  <!-- Synchronize Giscus theme with palette -->

  <script>
    // @ts-check

    const __md_get = /** @type {(_: "__palette") => { color: { scheme: "slate" | "light" } }} */ (window['__md_get']);
    const giscus = document.querySelector("script[src*=giscus]");

    /* Set color theme on initial load */
    {
      const palette = __md_get("__palette");
      if (palette && typeof palette.color === "object") {
        const theme = palette.color.scheme === "slate" ? "dark" : "light";
        giscus.setAttribute("data-theme", theme);
      }
    }

    /* Update color theme whenever palette changes */
    document.addEventListener("DOMContentLoaded", () => {
      const ref = document.querySelector("[data-md-component=palette]");
      ref.addEventListener("change", () => {
        const palette = __md_get("__palette");
        if (palette && typeof palette.color === "object") {
          const frame = /** @type HTMLIFrameElement */ (document.querySelector(".giscus-frame"));
          const theme = palette.color.scheme === "slate" ? "dark" : "light";
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          );
        }
      });
    });
  </script>
{% endif %}
